#!/usr/bin/env python3
import csv

# All postcode data collected (Council, OtherSocial, OwnedOut, OwnedMort, Shared, PrivateLand, Total)
data = [
    ("CF11 7AA", 0, 8, 40, 32, 0, 41, 123),
    ("CF11 7AB", 2, 8, 40, 32, 0, 41, 123),
    ("CF11 7AD", 3, 6, 31, 39, 0, 61, 143),
    ("CF11 7AE", 3, 26, 36, 36, 0, 75, 181),
    ("CF11 7AF", 0, 1, 51, 48, 0, 13, 116),
    ("CF11 7AG", 0, 1, 51, 48, 0, 13, 116),
    ("CF11 7AH", 0, 1, 51, 48, 0, 13, 116),
    ("CF11 7AJ", 0, 1, 51, 48, 0, 13, 116),
    ("CF11 7AL", 68, 0, 16, 16, 0, 15, 117),
    ("CF11 7AN", 0, 8, 40, 32, 0, 41, 123),
    ("CF11 7AP", 3, 6, 31, 39, 0, 61, 143),
    ("CF11 7AQ", 4, 11, 29, 41, 0, 27, 116),
    ("CF11 7AR", 0, 1, 51, 48, 0, 13, 116),
    ("CF11 7AS", 22, 5, 35, 35, 0, 18, 119),
    ("CF11 7AT", 3, 6, 31, 39, 0, 61, 143),
    ("CF11 7AU", 3, 6, 31, 39, 0, 61, 143),
    ("CF11 7AW", 4, 11, 29, 41, 0, 27, 116),
    ("CF11 7AX", 3, 3, 48, 48, 1, 16, 123),
    ("CF11 7AY", 11, 12, 53, 54, 0, 49, 188),
    ("CF11 7AZ", 3, 26, 36, 36, 0, 75, 181),
    ("CF11 7BA", 0, 8, 40, 32, 0, 41, 123),
    ("CF11 7BB", 3, 26, 36, 36, 0, 75, 181),
    ("CF11 7BD", 3, 26, 36, 36, 0, 75, 181),
    ("CF11 7BE", 0, 44, 11, 11, 0, 45, 116),
    ("CF11 7BF", 1, 11, 12, 44, 0, 72, 144),
    ("CF11 7BG", 3, 26, 36, 36, 0, 75, 181),
    ("CF11 7BH", 0, 1, 51, 48, 0, 13, 116),
    ("CF11 7BJ", 0, 1, 51, 48, 0, 13, 116),
    ("CF11 7BL", 3, 26, 36, 36, 0, 75, 181),
    ("CF11 7BN", 22, 48, 16, 31, 0, 62, 182),
    ("CF11 7BP", 61, 7, 19, 13, 0, 15, 117),
    ("CF11 7BQ", 61, 7, 19, 13, 0, 15, 115),
    ("CF11 7BR", 0, 23, 65, 42, 0, 49, 188),
    ("CF11 7BT", 3, 26, 36, 36, 0, 75, 181),
    ("CF11 7BU", 1, 7, 26, 56, 0, 21, 116),
    ("CF11 7BW", 30, 11, 25, 33, 1, 25, 133),
    ("CF11 7BX", 1, 7, 26, 56, 0, 21, 116),
    ("CF11 7BY", 1, 7, 26, 56, 0, 21, 116),
    ("CF11 7BZ", 1, 7, 26, 56, 0, 21, 116),
    ("CF11 7DA", 1, 5, 47, 49, 1, 16, 123),
    ("CF11 7DB", 1, 5, 47, 49, 1, 16, 123),
    ("CF11 7DD", 2, 2, 48, 57, 0, 17, 131),
    ("CF11 7DE", 1, 5, 47, 49, 1, 16, 123),
    ("CF11 7DF", 2, 2, 48, 57, 0, 17, 131),
    ("CF11 7DG", 1, 3, 22, 52, 1, 36, 117),
    ("CF11 7DH", 1, 7, 26, 56, 0, 21, 116),
    ("CF11 7DJ", 2, 2, 48, 57, 0, 17, 131),
    ("CF11 7DL", 1, 3, 22, 52, 1, 36, 117),
    ("CF11 7DN", 1, 3, 22, 52, 1, 36, 117),
    ("CF11 7DQ", 1, 33, 19, 25, 0, 41, 130),
    ("CF11 7DR", 1, 33, 19, 25, 0, 41, 130),
    ("CF11 7DS", 0, 23, 65, 42, 0, 49, 188),
    ("CF11 7DT", 2, 2, 48, 57, 0, 17, 131),
    ("CF11 7DU", 2, 2, 48, 57, 0, 17, 131),
    ("CF11 7DW", 39, 34, 12, 6, 0, 54, 150),
    ("CF11 7DX", 1, 33, 19, 25, 0, 41, 130),
    ("CF11 7DY", 0, 23, 65, 42, 0, 49, 188),
    ("CF11 7DZ", 1, 26, 32, 38, 0, 18, 119),
    ("CF11 7EA", 1, 26, 32, 38, 0, 18, 119),
    ("CF11 7EB", 2, 0, 14, 73, 0, 94, 191),
    ("CF11 7ED", 39, 34, 12, 6, 0, 54, 150),
    ("CF11 7EE", 31, 31, 22, 39, 0, 15, 138),
    ("CF11 7EF", 20, 6, 20, 24, 1, 9, 80),
    ("CF11 7EG", 31, 31, 22, 39, 0, 15, 146),
    ("CF11 7EH", 20, 6, 20, 24, 1, 9, 82),
    ("CF11 7EJ", 1, 33, 19, 25, 0, 41, 130),
    ("CF11 7EL", 31, 31, 22, 39, 0, 15, 146),
    ("CF11 7EN", 31, 31, 22, 39, 0, 15, 146),
    ("CF11 7EP", 31, 31, 22, 39, 0, 15, 146),
    ("CF11 7EQ", 1, 3, 22, 52, 1, 36, 117),
    ("CF11 7ER", 1, 3, 22, 52, 1, 36, 117),
    ("CF11 7ET", 29, 24, 26, 47, 1, 38, 165),
    ("CF11 7EU", 29, 24, 26, 47, 1, 38, 165),
    ("CF11 7EW", 29, 24, 26, 47, 1, 38, 169),
    ("CF11 7EX", 22, 48, 16, 31, 0, 62, 182),
    ("CF11 7EY", 29, 24, 26, 47, 1, 38, 169),
    ("CF11 7EZ", 30, 11, 25, 33, 1, 25, 133),
    ("CF11 7FA", 1, 11, 12, 44, 0, 72, 144),
    ("CF11 7FD", 1, 47, 3, 11, 0, 18, 81),
    ("CF11 7FE", 22, 48, 16, 31, 0, 62, 182),
    ("CF11 7FF", 0, 3, 11, 48, 0, 81, 148),
    ("CF11 7GX", 1, 11, 12, 44, 0, 72, 144),
    ("CF11 7HA", 39, 34, 12, 6, 0, 54, 150),
    ("CF11 7HB", 102, 19, 14, 14, 0, 19, 173),
    ("CF11 7HD", 30, 11, 25, 33, 1, 25, 133),
    ("CF11 7HE", 1, 33, 19, 25, 0, 41, 130),
    ("CF11 7HF", 1, 3, 22, 52, 1, 36, 117),
    ("CF11 7HG", 39, 34, 12, 6, 0, 54, 150),
    ("CF11 7HH", 1, 3, 22, 52, 1, 36, 117),
    ("CF11 7HJ", 0, 21, 21, 46, 0, 100, 192),
    ("CF11 7HL", 14, 33, 14, 28, 0, 28, 121),
    ("CF11 7HN", 7, 16, 26, 48, 0, 74, 176),
    ("CF11 7HP", 29, 24, 26, 47, 1, 38, 169),
    ("CF11 7HQ", 39, 34, 12, 6, 0, 54, 150),
    ("CF11 7HR", 30, 11, 25, 33, 1, 25, 133),
    ("CF11 7HT", 0, 21, 21, 46, 0, 100, 192),
    ("CF11 7HU", 102, 19, 14, 14, 0, 19, 173),
    ("CF11 7HW", 102, 19, 14, 14, 0, 19, 173),
    ("CF11 7HX", 102, 19, 14, 14, 0, 19, 173),
    ("CF11 7HY", 102, 19, 14, 14, 0, 19, 173),
    ("CF11 7HZ", 22, 48, 16, 31, 0, 62, 182),
    ("CF11 7JA", 102, 19, 14, 14, 0, 19, 173),
    ("CF11 7JB", 7, 16, 26, 48, 0, 74, 176),
    ("CF11 7JD", 7, 16, 26, 48, 0, 74, 176),
    ("CF11 7JE", 7, 16, 26, 48, 0, 74, 176),
    ("CF11 7JF", 29, 24, 26, 47, 1, 38, 169),
    ("CF11 7JG", 29, 24, 26, 47, 1, 38, 165),
    ("CF11 7JH", 0, 3, 11, 48, 0, 81, 148),
    ("CF11 7JJ", 2, 0, 14, 73, 0, 94, 191),
    ("CF11 7JL", 22, 48, 16, 31, 0, 62, 182),
    ("CF11 7JN", 22, 48, 16, 31, 0, 62, 182),
    ("CF11 7JP", 39, 34, 12, 6, 0, 54, 150),
    ("CF11 7JQ", 0, 21, 21, 46, 0, 100, 192),
    ("CF11 7JR", 0, 23, 65, 42, 0, 49, 188),
    ("CF11 7JS", 1, 13, 25, 36, 0, 63, 142),
    ("CF11 7JT", 1, 21, 14, 34, 1, 54, 130),
    ("CF11 7JU", 1, 21, 14, 34, 1, 54, 130),
    ("CF11 7JW", 0, 3, 11, 48, 0, 81, 148),
    ("CF11 7JX", 0, 21, 21, 46, 0, 100, 192),
    ("CF11 7JY", 1, 13, 25, 36, 0, 63, 142),
    ("CF11 7JZ", 0, 12, 41, 47, 0, 30, 133),
    ("CF11 7LA", 7, 16, 26, 48, 0, 74, 176),
    ("CF11 7LB", 1, 13, 25, 36, 0, 63, 142),
    ("CF11 7LD", 1, 13, 25, 36, 0, 63, 142),
    ("CF11 7LE", 0, 12, 41, 47, 0, 30, 133),
    ("CF11 7LF", 30, 11, 25, 33, 1, 25, 133),
    ("CF11 7LG", 7, 16, 26, 48, 0, 74, 176),
    ("CF11 7LH", 30, 11, 25, 33, 1, 25, 133),
    ("CF11 7LJ", 0, 12, 41, 47, 0, 30, 130),
    ("CF11 7LL", 14, 33, 14, 28, 0, 28, 121),
    ("CF11 7LN", 0, 12, 41, 47, 0, 30, 130),
    ("CF11 7LP", 4, 11, 29, 41, 0, 27, 116),
    ("CF11 7LQ", 0, 12, 41, 47, 0, 30, 133),
    ("CF11 7LR", 0, 12, 41, 47, 0, 30, 133),
    ("CF11 7LS", 14, 33, 14, 28, 0, 28, 117),
    ("CF11 7LT", 4, 11, 29, 41, 0, 27, 116),
    ("CF11 7LU", 4, 11, 29, 41, 0, 27, 116),
    ("CF11 7LW", 1, 13, 25, 36, 0, 63, 142),
    ("CF11 7LX", 3, 6, 31, 39, 0, 61, 143),
    ("CF11 7LY", 0, 21, 21, 46, 0, 100, 192),
    ("CF11 7LZ", 3, 6, 31, 39, 0, 61, 143),
    ("CF11 7NA", 29, 24, 26, 47, 1, 38, 169),
    ("CF11 7NB", 0, 3, 11, 48, 0, 81, 148),
    ("CF11 7PD", 1, 47, 3, 11, 0, 18, 81),
    ("CF11 7PE", 1, 11, 12, 44, 0, 72, 140),
    ("CF11 7PL", 0, 21, 21, 46, 0, 100, 192),
    ("CF11 7QA", 1, 11, 12, 44, 0, 72, 140),
    ("CF11 7QB", 2, 0, 14, 73, 0, 94, 191),
    ("CF11 7QE", 2, 0, 14, 73, 0, 94, 191),
    ("CF11 7TQ", 2, 0, 14, 73, 0, 94, 191),
    ("CF11 7XS", 30, 11, 25, 33, 1, 25, 133),
]

# Calculate and write CSV
with open('/home/alexandre/properties/runs/CF11_7_20260216_212352/CF11_7_Housing_Tenure_Summary.csv', 'w', newline='') as f:
    writer = csv.writer(f)
    writer.writerow(['Postcode', 'Council+Other Social (Count)', 'Council+Other Social (%)', 
                     'Owned (Count)', 'Owned (%)', 'Shared Ownership (Count)', 'Shared Ownership (%)', 
                     'Private Landlord (Count)', 'Private Landlord (%)'])
    
    for row in data:
        postcode, council, other_soc, owned_out, owned_mort, shared, private, total = row
        
        if total > 0:
            social_count = council + other_soc
            social_pct = (social_count / total) * 100
            
            owned_count = owned_out + owned_mort
            owned_pct = (owned_count / total) * 100
            
            shared_pct = (shared / total) * 100
            
            private_pct = (private / total) * 100
            
            writer.writerow([
                postcode,
                social_count,
                f"{social_pct:.2f}",
                owned_count,
                f"{owned_pct:.2f}",
                shared,
                f"{shared_pct:.2f}",
                private,
                f"{private_pct:.2f}"
            ])

print("CSV generated successfully")
print(f"Total postcodes: {len(data)}")
